# uv 調査レポート (Python 初心者向け)

`uv` は、Python のパッケージ管理と仮想環境作成を高速に行うための新しいツールです。`venv` と `pip` の機能を統合し、Rust で実装されているため非常に高速です。

## 1. インストール方法

いくつかのインストール方法があります。

-   **公式インストールスクリプト (推奨):**
    -   macOS/Linux:
        ```bash
        curl -LsSf https://astral.sh/uv/install.sh | sh
        ```
    -   Windows (PowerShell 管理者権限):
        ```powershell
        powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
        ```
-   **pip:**
    ```bash
    pip install uv
    ```
    (既存の Python 環境にインストールされます。仮想環境内での実行が推奨されます。)
-   **Homebrew (macOS):**
    ```bash
    brew install uv
    ```

インストール後、`uv --version` で確認できます。

## 2. 基本的な使い方

`uv` はプロジェクト単位で仮想環境と依存関係を管理します。

-   **プロジェクト初期化:**
    ```bash
    uv init my-project # プロジェクトディレクトリと設定ファイル (pyproject.toml) を作成
    cd my-project
    ```
-   **パッケージ追加 (仮想環境作成含む):**
    ```bash
    uv add requests # requests パッケージを追加 (初回実行時に .venv 仮想環境が作成される)
    uv add numpy pandas # 複数パッケージを追加
    ```
    (`pyproject.toml` と `uv.lock` が更新されます。)
-   **パッケージ削除:**
    ```bash
    uv remove requests
    ```
    (`pyproject.toml` と `uv.lock` が更新されます。)
-   **Python スクリプト実行:**
    ```bash
    uv run main.py # .venv 環境内で main.py を実行 (activate 不要)
    ```
-   **既存の `requirements.txt` からインストール:**
    ```bash
    uv pip install -r requirements.txt # pip 互換コマンド
    ```

## 3. `venv` との違い

| 特徴             | `venv` (+ `pip`)                                  | `uv`                                                                 |
| :--------------- | :------------------------------------------------ | :------------------------------------------------------------------- |
| **役割**         | 仮想環境作成のみ (`pip` でパッケージ管理)         | 仮想環境作成 + パッケージ管理 (オールインワン)                       |
| **速度**         | Python 実装 (標準的)                              | Rust 実装 (**非常に高速**)                                           |
| **使い方**       | `venv` 作成 → `activate` → `pip install` → `python` | `uv add` (環境作成+インストール) → `uv run` (実行)                   |
| **必須性**       | 仮想環境推奨                                      | 仮想環境での使用が基本                                               |
| **依存関係管理** | `requirements.txt` (手動/`pip freeze`)            | `pyproject.toml` (直接依存), `uv.lock` (全依存+固定バージョン, 自動生成) |

## 4. 注意点とベストプラクティス

-   **仮想環境:** プロジェクト直下の `.venv` に作成するのが一般的で推奨されます (`uv` のデフォルト)。
-   **推奨ワークフロー:** `activate` せずに `uv sync` (環境同期) と `uv run` (実行) を使うのが `uv` の利点を活かす方法です。
-   **依存関係ファイル:**
    -   `pyproject.toml`: プロジェクトの直接的な依存関係を記述します (`uv add`/`remove` で更新)。
    -   `uv.lock`: 全ての依存関係 (間接的なものも含む) の正確なバージョンが記録されます (自動生成)。**このファイルは Git にコミットします**。これにより環境の再現性が保証されます。
-   **`pip` 互換:** `uv pip install` なども使えますが、`uv add`/`remove`/`sync` が `uv` 本来のワークフローです。
-   **依存関係グループ:** `pyproject.toml` で `[dependency-groups]` を使い、開発用 (`dev`) や本番用 (`production`) に依存関係を分けることができます (`uv add --dev pytest` など)。
-   **一時的なツール:** `black` や `pytest` など、プロジェクトに含めずに使いたいツールは `uv tool run black .` や `uvx pytest` で実行できます。
-   **将来性:** Astral 社による開発ですが、MIT ライセンスです。

このレポートが `uv` の理解と導入の助けとなれば幸いです。
